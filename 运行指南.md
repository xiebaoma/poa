# Python+Spark 热词分析系统 - 运行指南

## 系统要求

1. **Python 3.7+** （推荐 Python 3.8 或更高版本）
2. **Java 8+** （如果使用 Spark 功能，可选但推荐）
3. **Windows 10/11** 或 **Linux/Mac**

## 快速开始

### 步骤 1: 安装 Python 依赖

在项目根目录下运行：

```bash
pip install -r requirements.txt
```

或者如果使用国内镜像（推荐，速度更快）：

```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 步骤 2: 安装 Java（可选，用于 Spark）

如果计划使用 Spark 功能，需要安装 Java：

1. **Windows:**
   - 下载并安装 [Java JDK 8+](https://www.oracle.com/java/technologies/downloads/)
   - 设置环境变量 `JAVA_HOME` 指向 Java 安装目录
   - 例如：`JAVA_HOME = C:\Program Files\Java\jdk-11`

2. **Linux/Mac:**
   ```bash
   # Ubuntu/Debian
   sudo apt-get install openjdk-11-jdk
   
   # Mac
   brew install openjdk@11
   ```

**注意：** 如果不安装 Java，程序会自动使用 Pandas 进行数据处理（功能相同，但速度可能稍慢）。

### 步骤 3: 检查数据文件

确保以下文件存在：
- `data/covid_weibo_train.csv` - 微博数据文件（已存在）
- `data/stopwords.txt` - 停用词文件（已存在）

### 步骤 4: 运行程序

在项目根目录下运行：

```bash
python main.py
```

或者直接双击 `main.py` 文件（如果已配置 Python 文件关联）。

## 程序功能

1. **数据加载**: 加载 COVID-19 微博情感数据集
2. **词频分析**: 使用 jieba 分词，统计热词频率
3. **情感分析**: 使用 SnowNLP 分析文本情感倾向
4. **可视化**: 
   - 词云图
   - 热词排行榜柱状图
   - 情感分布饼图
5. **数据导出**: 将分析结果导出为 CSV 文件

## 使用说明

1. **启动程序**: 运行 `python main.py` 后，会打开图形界面
2. **加载数据**: 点击"📊 加载数据"按钮加载数据集
3. **设置参数**:
   - 选择日期范围（可选）
   - 设置 Top N 热词数量（默认 20）
   - 选择是否使用 Spark（如果已安装）
4. **开始分析**: 点击"🔍 开始分析"按钮
5. **查看结果**: 
   - 左侧显示词云和统计图表
   - 右侧显示热词排行榜和情感分布
6. **导出结果**: 点击"💾 导出结果"保存分析结果

## 常见问题

### 1. 依赖安装失败

**问题**: `pip install` 报错或速度很慢

**解决方案**:
- 使用国内镜像源：
  ```bash
  pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
  ```
- 或者使用阿里云镜像：
  ```bash
  pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/
  ```

### 2. PySpark 安装失败或无法使用

**问题**: Spark 相关功能不可用

**解决方案**:
- 这是正常的，程序会自动使用 Pandas 作为后备方案
- 如果需要使用 Spark，确保：
  1. 已安装 Java 并设置 `JAVA_HOME`
  2. 重新安装 PySpark: `pip install pyspark==3.5.3`

### 3. 词云显示乱码

**问题**: 词云中的中文显示为方框

**解决方案**:
- 程序会自动尝试使用系统字体
- 如果需要，可以下载中文字体（如 simhei.ttf）放到 `data/` 目录下

### 4. 数据加载失败

**问题**: 提示找不到数据文件

**解决方案**:
- 确保 `data/covid_weibo_train.csv` 文件存在
- 检查文件路径是否正确
- 确保 CSV 文件包含以下列：`date`, `text` 或 `content`

### 5. 内存不足

**问题**: 处理大数据集时内存不足

**解决方案**:
- 使用日期范围筛选，只分析部分数据
- 减少 Top N 数量
- 关闭其他占用内存的程序

## 依赖包说明

- **pandas**: 数据处理
- **jieba**: 中文分词
- **snownlp**: 情感分析
- **matplotlib**: 图表绘制
- **wordcloud**: 词云生成
- **Pillow**: 图像处理
- **pyspark**: Spark 数据处理（可选）
- **ttkbootstrap**: 现代化 GUI 主题（可选）

## 技术支持

如果遇到问题，请检查：
1. Python 版本是否符合要求
2. 所有依赖是否已正确安装
3. 数据文件是否存在且格式正确
4. 查看控制台输出的错误信息

## 注意事项

- 首次运行可能需要下载 jieba 和 snownlp 的模型文件，请保持网络连接
- 处理大量数据时可能需要较长时间，请耐心等待
- 建议在分析前先使用日期范围筛选，减少处理时间

